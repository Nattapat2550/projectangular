{"ast":null,"code":"import { Router } from '@angular/router';\nimport { inject } from '@angular/core';\nimport { AuthService } from '../services/auth.service';\nexport const roleGuard = route => {\n  const auth = inject(AuthService);\n  const router = inject(Router);\n  const allow = route.data?.['allow'] ?? [];\n  if (!auth.isLoggedIn()) {\n    router.navigateByUrl('/'); // not logged in -> index\n    return false;\n  }\n  const role = auth.user()?.role || 'user';\n  // If user role is 'user' and tries to access pages not allowed -> go to /home\n  if (role === 'user' && allow.length && !allow.includes('user')) {\n    router.navigateByUrl('/home');\n    return false;\n  }\n  // Admin-only gate\n  if (allow.length && !allow.includes(role)) {\n    router.navigateByUrl('/home');\n    return false;\n  }\n  return true;\n};","map":{"version":3,"names":["Router","inject","AuthService","roleGuard","route","auth","router","allow","data","isLoggedIn","navigateByUrl","role","user","length","includes"],"sources":["C:\\Users\\DELL-GUITAR\\Desktop\\projectangular\\frontend-angular\\src\\app\\core\\guards\\role.guard.ts"],"sourcesContent":["\nimport { CanActivateFn, Router, ActivatedRouteSnapshot } from '@angular/router';\nimport { inject } from '@angular/core';\nimport { AuthService } from '../services/auth.service';\n\nexport const roleGuard: CanActivateFn = (route: ActivatedRouteSnapshot) => {\n  const auth = inject(AuthService);\n  const router = inject(Router);\n  const allow = (route.data?.['allow'] as string[]) ?? [];\n\n  if (!auth.isLoggedIn()) {\n    router.navigateByUrl('/'); // not logged in -> index\n    return false;\n  }\n  const role = auth.user()?.role || 'user';\n  // If user role is 'user' and tries to access pages not allowed -> go to /home\n  if (role === 'user' && allow.length && !allow.includes('user')) {\n    router.navigateByUrl('/home');\n    return false;\n  }\n  // Admin-only gate\n  if (allow.length && !allow.includes(role)) {\n    router.navigateByUrl('/home');\n    return false;\n  }\n  return true;\n};\n"],"mappings":"AACA,SAAwBA,MAAM,QAAgC,iBAAiB;AAC/E,SAASC,MAAM,QAAQ,eAAe;AACtC,SAASC,WAAW,QAAQ,0BAA0B;AAEtD,OAAO,MAAMC,SAAS,GAAmBC,KAA6B,IAAI;EACxE,MAAMC,IAAI,GAAGJ,MAAM,CAACC,WAAW,CAAC;EAChC,MAAMI,MAAM,GAAGL,MAAM,CAACD,MAAM,CAAC;EAC7B,MAAMO,KAAK,GAAIH,KAAK,CAACI,IAAI,GAAG,OAAO,CAAc,IAAI,EAAE;EAEvD,IAAI,CAACH,IAAI,CAACI,UAAU,EAAE,EAAE;IACtBH,MAAM,CAACI,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC;IAC3B,OAAO,KAAK;EACd;EACA,MAAMC,IAAI,GAAGN,IAAI,CAACO,IAAI,EAAE,EAAED,IAAI,IAAI,MAAM;EACxC;EACA,IAAIA,IAAI,KAAK,MAAM,IAAIJ,KAAK,CAACM,MAAM,IAAI,CAACN,KAAK,CAACO,QAAQ,CAAC,MAAM,CAAC,EAAE;IAC9DR,MAAM,CAACI,aAAa,CAAC,OAAO,CAAC;IAC7B,OAAO,KAAK;EACd;EACA;EACA,IAAIH,KAAK,CAACM,MAAM,IAAI,CAACN,KAAK,CAACO,QAAQ,CAACH,IAAI,CAAC,EAAE;IACzCL,MAAM,CAACI,aAAa,CAAC,OAAO,CAAC;IAC7B,OAAO,KAAK;EACd;EACA,OAAO,IAAI;AACb,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}