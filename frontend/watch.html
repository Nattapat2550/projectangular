<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Watch</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <main class="container">
    <a href="/" class="muted">‚Üê Back</a>
    <h1 id="title">Watch</h1>
    <video id="player" controls preload="metadata" width="100%"></video>
    <p id="desc" class="muted"></p>
  </main>
  <script>
    const id = new URLSearchParams(location.search).get('id');
    if (!id) {
      document.body.innerHTML = '<p class="container">Missing id</p>';
    } else {
      fetch(`/api/videos/${id}`)
        .then(r => r.json())
        .then(doc => {
          document.getElementById('title').textContent = doc.metadata?.title || doc.filename;
          document.getElementById('desc').textContent = doc.metadata?.description || '';
          const v = document.getElementById('player');
          if (doc.metadata?.posterUrl) v.setAttribute('poster', doc.metadata.posterUrl);
          v.src = `/api/videos/${id}/stream`;
        }).catch(() => {
          document.body.innerHTML = '<p class="container">Not found</p>';
        });
    }
  </script>
</body>
</html>
